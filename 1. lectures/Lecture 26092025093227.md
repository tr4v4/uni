---
tags:
  - category/lecture
  - status/finished
  - topic/progetto-di-sistemi-virtuali
date: 26-09-2025 09:32:27
teacher: renzo.davoli@unibo.it
mod: 1
---
# Lezione
---
## Concetti
- IPv6
	- usa indirizzo _link-local_ (`fe80:...`) per parlare con i dispositivi nella rete locale
		- viene costruito usando il MAC address
		- proprio grazie a questo IPv6 per parlare con la rete locale è già autoconfigurato!
		- quindi il DHCP IPv4, per esempio, in IPv6 si può fare parlando direttamente in IPv6, e non usando il broadcast MAC (ma il broadcast IPv6!)
			- di fatto il DHCP non "serve" in IPv6, e può fornire informazioni sul router magari (suo IPv6)
- differenza tra hub e switch
	- _hub_: ... -> ethernet funziona, basta scartare i pacchetti non destinati a me;
	- _bridge_: interfaccia due sistemi con hub, tale che il primo broadcast viene inoltrato dall'altra parte, poi il bridge in base alla risposta capisce se la risposta dovrà essere inoltrata o meno; se la risposta è dalla stessa parte da dove è partito il broadcast allora non lo rimanda dall'altra parte, altrimenti sì;
		- in questo modo partiziona la comunicazione tra due reti hub, in modo da diminuire il traffico broadcast
- switch vde (`vde_plug`)
	- è fatto con un doppio pipe!
	- `dpipe vde_plug /tmp/sw1 = vde_plug /tmp/sw2`
	- ma posso anche fare `dpipe vde_plug /tmp/sw1 = ssh hostremote.org vde_plug /tmp/sw2`
		- nota bene: si può configurare `ssh` in modo che usi un meccanismo di chiave pubblica/privata
		- `ssh-keygen -t rsa 2048 -C "example@mail.com`
- ma perché limitarci a un solo modo per connettere le macchine virtuali?
	- metafora con SFP
	- ![[libvdeplug4.png]]
	- bisogna fare un'API per i plugin VDE in modo che sia facile configurarsi con libdevplug4
		- si usa VNL (simile a URL)
		- esempio:
			- `null://` - il connettore butta tutto;
			- `vde:///var/run/myswitch` - il connettore si interfaccia con uno switch (vde_switch);
			- `tap://tap0` - connette l'interfaccia alla macchina reale;
			- `vxvde://234.0.0.1`
			- ...
			- `hub://`
			- `switch://`
	- namespace - servono per isolare i processi tra di loro, facendo vedere loro solo certe variabili
		- è il meccanismo dietro docker
		- di usa `vdens`, e in quel modo i processi entrano nel namespace della rete specificata (dalla porta vde_plug), e hanno una visione loro della rete
		- si può vedere con wireshark, perché quel processo (bash) ora vede quell'interfaccia essendo nel suo namespace
	- facciamo con `tap`
		- `ip tuntap add mode tap user renzo name tapx`
			- crea un'interfaccia fisica (in realtà sempre virtuale, ma vista dal sistema operativo dell'host fisico) a cui si può attaccare un'interfaccia virtuale
		- `ip addr`
		- `ip addr add 10.0.1.1/24 dev tapx`
		- `ip link set tapx up`
		- `vde_plug tap://tapx switch://tmp/sw`
		- altro terminale - `vdens vde:///tmp/sw`
		- `ip addr add 10.0.1.2/24 vde0`
		- `ip link set vde0 up`
		- `ping 10.0.1.1`
	- plugin `pickup` di vde per connettere macchina virtuale a rete locale del computer ospitante
	- `slirp` - una sorta di proto-proxy
		- per collegare una macchina virtuale alla rete potremmo usare `tap`, ma serve `root` --> allora usiamo `slirp`!
		- comandi
			- `ip link set eth0 up`
			- `udhcp -i eth0`
				- `slirp` dà sempre indirizzo `10.0.2.15`
	- Renzo ha fatto `sshlirp`
		- incredibile... consente di creare una VPN usando una sola connessione SSH verso il computer da cui vuoi che partano le richieste
	- `wirefilter`
		- `wirefilter hub:///tmp/h1 hub:///tmp/h2`
		- è un filo programmabile!
		- si possono fare esperimenti sui protocolli!

## Domande

## Referenze
