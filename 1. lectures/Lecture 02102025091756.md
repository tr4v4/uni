---
tags:
  - category/lecture
  - status/pending
  - topic/progetto-di-sistemi-virtuali
date: 02-10-2025 09:17:56
teacher:
mod: 2
---
# Lezione
---
## Concetti
- tap
	- oggetto che interconnette una macchina virtuale con la rete di quella fisica
	- oggetto fatto da un lato come un'interfaccia di rete
		- possiamo aggiungerci un IP
	- e dall'altra parte c'è un oggetto fisico, la scheda di rete
	- dalla macchina virtuale si legge come un file, possiamo accederci con metodi di input/output
	- differenza tra tun e tap
		- sono lo stesso oggetti, ma:
			- tap - frame Ethernet, livello 2
			- tun - pacchetti raw IP, livello 3
				- non essendo possibile fare switching, ci si aspetta sempre una connessione 2 a 2, un tunnel!
	- molto utile la tap!
		- possiamo connettere l'interfaccia virtuale a un VDE switch, che a sua volta interconnette macchine virtuali, e grazie al tap poter comunicare con il mondo reale!
- `libpcap`
	- si basano programmi come `tcpdump`, per catturare e analizzare i pacchetti
	- `tshask` - come il precedente ma più colorato
	- `wireshark` - GUI totale
- ricorda che frame ethernet comincia sempre con indirizzo di destinazione
	- contiene il campo type, es. `IPv4`
- header pacchetto
	- contiene anche checksum
- `tap`
	- non viene creato un tap per ogni file
	- è un file speciale, `/dev/net/tun`
	- syscall `ioctl`
- ARP
	- funzionamento sicuro --> è una negoziazione sicura, si stabilisce prima di inviare qualunque cosa l'associazione MAC-IP
		- se quindi invio un pacchetto a un host, e quest'ultimo non conosce il MAC del destinatario nella sua tabella MAC, non lo aggiunge direttamente dal frame, ma fa prima una richiesta ARP --> questo rende più sicuro il protocollo da attacchi di ARP poisoning
- per rendere il computer un router
	- `echo "1" | sudo tee /proc/sys/net/ipv4/ip_forward`
	- e poi comando con `iptables` per abilitare NAT
	- quando da fuori si vuole accedere a un computer interno alla rete locale, DNAT;
	- quando da dentro si vuole accedere a fuori, SNAT;
		- di solito con tag MASQUERADE (ossia lascia al router la gestione dell'associazione, automatica)

## Domande

## Referenze
